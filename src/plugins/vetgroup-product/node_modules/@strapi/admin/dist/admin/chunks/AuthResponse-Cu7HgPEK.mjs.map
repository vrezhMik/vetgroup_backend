{"version":3,"file":"AuthResponse-Cu7HgPEK.mjs","sources":["../../../ee/admin/src/utils/cookies.ts","../../../ee/admin/src/pages/AuthResponse.tsx"],"sourcesContent":["export const getCookieValue = (name: string) => {\n  let result = null;\n  const cookieArray = document.cookie.split(';');\n  cookieArray.forEach((cookie) => {\n    const [key, value] = cookie.split('=').map((item) => item.trim());\n    if (key.trim() === name) {\n      result = decodeURIComponent(value);\n    }\n  });\n  return result;\n};\n\nexport const deleteCookie = (name: string) => {\n  // Set the cookie to expire in the past\n  document.cookie = name + '=; Path=/; Expires=Thu, 01 Jan 1970 00:00:01 GMT;';\n};\n","import * as React from 'react';\n\nimport { useIntl } from 'react-intl';\nimport { useNavigate, useMatch } from 'react-router-dom';\n\nimport { Page } from '../../../../admin/src/components/PageHelpers';\nimport { useTypedDispatch } from '../../../../admin/src/core/store/hooks';\nimport { login } from '../../../../admin/src/reducer';\nimport { getCookieValue, deleteCookie } from '../utils/cookies';\n\nconst AuthResponse = () => {\n  const match = useMatch('/auth/login/:authResponse');\n  const { formatMessage } = useIntl();\n  const navigate = useNavigate();\n  const dispatch = useTypedDispatch();\n\n  const redirectToOops = React.useCallback(() => {\n    navigate({\n      pathname: '/auth/oops',\n      search: `?info=${encodeURIComponent(\n        formatMessage({\n          id: 'Auth.form.button.login.providers.error',\n          defaultMessage: 'We cannot connect you through the selected provider.',\n        })\n      )}`,\n    });\n  }, [navigate, formatMessage]);\n\n  React.useEffect(() => {\n    if (match?.params.authResponse === 'error') {\n      redirectToOops();\n    }\n\n    if (match?.params.authResponse === 'success') {\n      const jwtToken = getCookieValue('jwtToken');\n\n      if (jwtToken) {\n        dispatch(\n          login({\n            token: jwtToken,\n          })\n        );\n\n        deleteCookie('jwtToken');\n\n        navigate('/auth/login');\n      } else {\n        redirectToOops();\n      }\n    }\n  }, [dispatch, match, redirectToOops, navigate]);\n\n  return <Page.Loading />;\n};\n\nexport { AuthResponse };\n"],"names":["getCookieValue","name","result","cookieArray","document","cookie","split","forEach","key","value","map","item","trim","decodeURIComponent","deleteCookie","AuthResponse","match","useMatch","formatMessage","useIntl","navigate","useNavigate","dispatch","useTypedDispatch","redirectToOops","React","useCallback","pathname","search","encodeURIComponent","id","defaultMessage","useEffect","params","authResponse","jwtToken","login","token","_jsx","Page","Loading"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;AAAO,MAAMA,iBAAiB,CAACC,IAAAA,GAAAA;AAC7B,IAAA,IAAIC,MAAS,GAAA,IAAA;AACb,IAAA,MAAMC,WAAcC,GAAAA,QAAAA,CAASC,MAAM,CAACC,KAAK,CAAC,GAAA,CAAA;IAC1CH,WAAYI,CAAAA,OAAO,CAAC,CAACF,MAAAA,GAAAA;AACnB,QAAA,MAAM,CAACG,GAAAA,EAAKC,KAAM,CAAA,GAAGJ,MAAOC,CAAAA,KAAK,CAAC,GAAA,CAAA,CAAKI,GAAG,CAAC,CAACC,IAAAA,GAASA,KAAKC,IAAI,EAAA,CAAA;QAC9D,IAAIJ,GAAAA,CAAII,IAAI,EAAA,KAAOX,IAAM,EAAA;AACvBC,YAAAA,MAAAA,GAASW,kBAAmBJ,CAAAA,KAAAA,CAAAA;AAC9B;AACF,KAAA,CAAA;IACA,OAAOP,MAAAA;AACT,CAAE;AAEK,MAAMY,eAAe,CAACb,IAAAA,GAAAA;;IAE3BG,QAASC,CAAAA,MAAM,GAAGJ,IAAO,GAAA,mDAAA;AAC3B,CAAE;;ACLF,MAAMc,YAAe,GAAA,IAAA;AACnB,IAAA,MAAMC,QAAQC,QAAS,CAAA,2BAAA,CAAA;IACvB,MAAM,EAAEC,aAAa,EAAE,GAAGC,OAAAA,EAAAA;AAC1B,IAAA,MAAMC,QAAWC,GAAAA,WAAAA,EAAAA;AACjB,IAAA,MAAMC,QAAWC,GAAAA,gBAAAA,EAAAA;IAEjB,MAAMC,cAAAA,GAAiBC,KAAMC,CAAAA,WAAW,CAAC,IAAA;QACvCN,QAAS,CAAA;YACPO,QAAU,EAAA,YAAA;AACVC,YAAAA,MAAAA,EAAQ,CAAC,MAAM,EAAEC,kBAAAA,CACfX,aAAc,CAAA;gBACZY,EAAI,EAAA,wCAAA;gBACJC,cAAgB,EAAA;AAClB,aAAA,CAAA,CAAA,CACA;AACJ,SAAA,CAAA;KACC,EAAA;AAACX,QAAAA,QAAAA;AAAUF,QAAAA;AAAc,KAAA,CAAA;AAE5BO,IAAAA,KAAAA,CAAMO,SAAS,CAAC,IAAA;QACd,IAAIhB,KAAAA,EAAOiB,MAAOC,CAAAA,YAAAA,KAAiB,OAAS,EAAA;AAC1CV,YAAAA,cAAAA,EAAAA;AACF;QAEA,IAAIR,KAAAA,EAAOiB,MAAOC,CAAAA,YAAAA,KAAiB,SAAW,EAAA;AAC5C,YAAA,MAAMC,WAAWnC,cAAe,CAAA,UAAA,CAAA;AAEhC,YAAA,IAAImC,QAAU,EAAA;AACZb,gBAAAA,QAAAA,CACEc,KAAM,CAAA;oBACJC,KAAOF,EAAAA;AACT,iBAAA,CAAA,CAAA;gBAGFrB,YAAa,CAAA,UAAA,CAAA;gBAEbM,QAAS,CAAA,aAAA,CAAA;aACJ,MAAA;AACLI,gBAAAA,cAAAA,EAAAA;AACF;AACF;KACC,EAAA;AAACF,QAAAA,QAAAA;AAAUN,QAAAA,KAAAA;AAAOQ,QAAAA,cAAAA;AAAgBJ,QAAAA;AAAS,KAAA,CAAA;IAE9C,qBAAOkB,GAAA,CAACC,KAAKC,OAAO,EAAA,EAAA,CAAA;AACtB;;;;"}